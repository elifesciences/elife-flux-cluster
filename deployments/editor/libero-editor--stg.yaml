---
apiVersion: helm.fluxcd.io/v1
kind: HelmRelease
metadata:
  name: libero-editor--stg
  namespace: editor
  annotations:
    fluxcd.io/automated: "true"
    filter.fluxcd.io/client: glob:master-*-*
    filter.fluxcd.io/articleStore: glob:master-*-*

spec:
  releaseName: libero-editor--stg
  chart:
    git: https://github.com/elifesciences/libero-editor-formula
    path: helm/libero-editor
    ref: master

  values:
    replicaCount: 1
    ingress:
      host: libero-editor--staging.elifesciences.org
    client:
      image:
        repository: liberoadmin/editor-client
        tag: master-11b27a3c-20210121.2138
    articleStore:
      image:
        repository: liberoadmin/editor-article-store
        tag: master-22639cd3-20210121.0928

    database:
      endpoint: 'documentdbcluster-yvl13z5rkw22.cluster-cxyopn44uqbl.us-east-1.docdb.amazonaws.com:27017'
      query: 'ssl=true&replicaSet=rs0&readPreference=secondaryPreferred'
      secret: libero-editor--stg-database-secret
      name: 'editor'
    aws:
      region: 'us-east-1'
      secret: libero-editor--stg-aws-secret
      sqsUrl: 'https://sqs.us-east-1.amazonaws.com/512686554592/elife-libero-editor-import--staging'
      bucket: 'stg-elife-editor'
