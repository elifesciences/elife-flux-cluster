apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization
resources:
- ../../karpenter
- ../../nodepools

patches:
- target:
    kind: HelmRelease
  patch: |
    apiVersion: helm.toolkit.fluxcd.io/v2
    kind: HelmRelease
    metadata:
      name: notused
    spec:
      values:
        settings:
          clusterName: kubernetes-aws--${cluster_name}
        serviceAccount:
          annotations:
            eks.amazonaws.com/role-arn: ${aws_karpenter_service_account_role_arn}
