apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization
namespace: data-hub--test
resources:
- ../../base
- ../test-ftpserver

- updateautomation.yaml

- secrets/europepmc-labslink-ftp-credentials.yaml
- secrets/fernet-key.yaml
- secrets/monitoring-urls.yaml
- secrets/webserver-secret-key.yaml
- secrets/civi-key.yaml
- secrets/credentials.yaml
- secrets/gcloud.yaml
- secrets/gmail-open-research.yaml
- secrets/gmail.yaml
- secrets/google-auth.yaml
- secrets/surveymonkey.yaml
- secrets/toggl.yaml
- secrets/twitter.yaml

patches:
- path: patches/data-hub-image.yaml
- path: patches/ingress.yaml
- path: patches/airflow-configs.yaml
- patch: |-
    - op: add
      path: /spec/values/airflow/extraEnv/10/value
      value: s3://test-elife-data-pipeline/airflow-config/bigquery-views
  target:
    kind: HelmRelease
    name: data-hub
    namespace: data-hub
- patch: |-
    - op: add
      path: /spec/values/airflow/extraEnv/36/value
      value: test
  target:
    kind: HelmRelease
    name: data-hub
    namespace: data-hub
- patch: |-
    - op: add
      path: /spec/values/airflow/extraEnv/47/value
      value: test
  target:
    kind: HelmRelease
    name: data-hub
    namespace: data-hub
configMapGenerator:
- name: data-hub-configs
  behavior: merge
  files:
  - configs/europepmc-labslink.config.yaml
